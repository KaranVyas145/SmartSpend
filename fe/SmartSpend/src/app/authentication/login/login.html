<!-- Full height container -->
<div class="login-container">
    <!-- Two-column layout using Bootstrap grid -->
    <div class="row g-0 h-100">

        <!-- LEFT SIDE - Branding/Welcome (same as before) -->
        <div class="col-lg-6 d-none d-lg-flex">
            <div class="welcome-section">
                <div class="welcome-content">
                    <img src="assets/images/logo/smartspends-icon.png" alt="SmartSpends" class="welcome-icon mb-4">

                    <h2 class="welcome-title">Welcome Back!</h2>
                    <p class="welcome-subtitle">
                        Sign in to continue managing your finances with SmartSpends
                    </p>

                    <div class="welcome-features">
                        <div class="feature-item">
                            <i class="feature-icon">üìä</i>
                            <span>Track Expenses</span>
                        </div>
                        <div class="feature-item">
                            <i class="feature-icon">üéØ</i>
                            <span>Smart Budgets</span>
                        </div>
                        <div class="feature-item">
                            <i class="feature-icon">üìà</i>
                            <span>Financial Insights</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- RIGHT SIDE - Login Form with Reactive Forms -->
        <div class="col-lg-6 col-12">
            <div class="form-section">
                <div class="form-container">

                    <!-- Mobile logo -->
                    <div class="d-lg-none text-center mb-4">
                        <img src="assets/images/smartspends-icon.png" alt="SmartSpends"
                            style="width: 80px; height: auto;">
                    </div>

                    <!-- Form header -->
                    <div class="text-center mb-5">
                        <h3 class="form-title">Sign In</h3>
                        <p class="text-muted">Enter your credentials to access your account</p>
                    </div>

                    <!-- REACTIVE FORM -->
                    <form [formGroup]="loginForm" (ngSubmit)="onLogin()" novalidate>
                        <!-- [formGroup]: Binds form to our reactive form group -->
                        <!-- (ngSubmit): Calls onLogin() when form is submitted -->
                        <!-- novalidate: Disables browser's default validation -->

                        <!-- Email Input with Reactive Form Control -->
                        <div class="mb-3">
                            <label for="email" class="form-label">Email Address</label>
                            <input type="email" id="email" class="form-control form-control-lg"
                                [class.is-invalid]="hasError('email', 'required') || hasError('email', 'email')"
                                formControlName="email" placeholder="Enter your email">
                            <!-- formControlName: Links input to reactive form control -->
                            <!-- [class.is-invalid]: Adds Bootstrap error class if field has errors -->

                            <!-- Email validation errors -->
                            @if(email && email.invalid && (email.dirty || email.touched))
                            {
                            <div class="invalid-feedback">
                                <!-- *ngIf: Only show if field is invalid and user has interacted -->
                                {{ getErrorMessage('email') }}
                                <!-- {{ }}: Display the specific error message -->
                            </div>
                            }

                        </div>

                        <!-- Password Input with Reactive Form Control -->
                        <div class="mb-3">
                            <label for="password" class="form-label">Password</label>
                            <div class="input-group input-group-lg">
                                <input [type]="showPassword ? 'text' : 'password'" id="password" class="form-control"
                                    [class.is-invalid]="hasError('password', 'required') || hasError('password', 'minlength')"
                                    formControlName="password" placeholder="Enter your password">
                                <!-- [type]: Dynamic type based on showPassword boolean -->

                                <!-- Password toggle button -->
                                <button type="button" class="btn btn-outline-secondary"
                                    (click)="togglePasswordVisibility()">
                                    <i class="password-toggle-icon">
                                        {{ showPassword ? 'üôà' : 'üëÅÔ∏è' }}
                                    </i>
                                </button>
                            </div>

                            <!-- Password validation errors -->
                            @if(password && password.invalid && (password.dirty || password.touched))
                            {
                            <div class="invalid-feedback">
                                {{ getErrorMessage('password') }}
                            </div>
                            }

                        </div>

                        <!-- Remember Me & Forgot Password -->
                        <div class="d-flex justify-content-between align-items-center mb-4">
                            <div class="form-check">
                                <input type="checkbox" class="form-check-input" id="rememberMe">
                                <label class="form-check-label" for="rememberMe">
                                    Remember me
                                </label>
                            </div>

                            <a routerLink="/forgot-password" class="text-decoration-none">
                                Forgot Password?
                            </a>
                        </div>

                        <!-- Submit Button with Form Validation -->
                        <button type="submit" class="btn btn-primary btn-lg w-100 mb-3"
                            [disabled]="authenticationService.isLoading() || loginForm.invalid">
                            <!-- [disabled]: Button disabled if form invalid or loading -->

                            <!-- Loading spinner -->
                            @if(authenticationService.isLoading())
                            {
                            <span class="spinner-border spinner-border-sm me-2" role="status">
                            </span>
                            }

                             {{ authenticationService.isLoading() ? 'Signing In...' : 'Sign In' }}
                        </button>


                    </form>

                    <!-- Sign up link -->
                    <div class="text-center">
                        <p class="mb-0">
                            Don't have an account?
                            <a routerLink="/register" class="text-decoration-none fw-bold">
                                Sign up here
                            </a>
                        </p>
                    </div>

                </div>
            </div>
        </div>

    </div>
</div>